<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="web.dao.face.MenuRentDao">

	<!-- 게시글 조회용 SQL -->
	<sql id="selectBoard">
		SELECT
			board_no, writer_id, writer_nick, write_date, hit, menu
			, title, price, content, location
		FROM board
		<where>
			menu = #{menu }
		</where>
	</sql>

	<!-- 게시글 수 조회하여 페이징 처리 -->
	<select id="selectCntAll" resultType="int" parameterType="web.util.Paging">
		SELECT count(*) FROM (
			<include refid="selectBoard" />
		)
	</select>
	
	<!-- 해당 메뉴 게시글 조회 -->
	<select id="selectAll" resultType="Board" parameterType="web.util.Paging">
		SELECT * FROM (
		    SELECT rownum rnum, B.* FROM (
				<include refid="selectBoard" />
				ORDER BY board_no DESC
		    ) B
		) WHERE rnum BETWEEN #{startNo} AND #{endNo}
	</select>
	
	<!-- 게시글 조회수 증가 -->
	<update id="updateHit" parameterType="Board">
		UPDATE board
		<set>
			hit = hit + 1,
		</set>
		<where>
			AND board_no = #{boardNo }
		</where>
	</update>
	
	<!-- 게시글 상세 조회 -->
	<select id="selectByBoardNo" resultType="Board" parameterType="Board">
		<include refid="selectBoard" />
		<where>
			AND board_no = #{boardNo }
		</where>
	</select>

</mapper>